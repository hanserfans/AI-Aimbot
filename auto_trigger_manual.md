# 自动扳机系统用户手册

## 📖 系统概述

自动扳机系统是AI瞄准机器人的智能射击模块，能够检测准星与目标的对齐程度，并在满足条件时自动执行射击动作。系统使用**G-Hub驱动**进行硬件级鼠标控制，提供更稳定和安全的射击体验。

## ✨ 核心功能

### 🎯 智能对齐检测
- **距离计算**: 实时计算准星与目标头部的像素距离
- **阈值判断**: 可配置的对齐阈值（默认15像素）
- **头部偏移**: 支持头部位置偏移补偿

### 🔫 自动射击 (G-Hub驱动)
- **硬件级控制**: 使用罗技G-Hub驱动进行鼠标点击
- **连发射击**: 默认每次触发连发2枪
- **射击间隔**: 可配置的连发间隔时间
- **冷却机制**: 0.5秒冷却时间防止过度射击

### ⚙️ 灵活配置
- 可调节对齐阈值
- 可调节冷却时间
- 可调节连发数量
- 实时开关控制

## 操作指南

### 基本控制

| 按键 | 功能 | 说明 |
|------|------|------|
| **Caps Lock** | 切换扳机功能 | 启用/禁用自动扳机 |
| **R** | 显示状态 | 查看扳机系统当前状态 |

### 使用流程

1. **启动程序**
   ```bash
   python main_onnx.py
   ```

2. **启用扳机功能**
   - 按下 `Caps Lock` 键启用自动扳机
   - 系统会显示"自动扳机功能已启用"

3. **正常游戏**
   - 使用现有的瞄准功能（Caps Lock）
   - 当目标头部与准星对齐时，系统自动射击
   - 无需手动开火

4. **查看状态**
   - 按下 `R` 键查看详细状态信息
   - 包括触发次数、射击次数等统计

5. **禁用功能**
   - 再次按下 `Caps Lock` 键禁用扳机功能

## 技术参数

### 默认设置
- **对齐阈值**: 15.0像素
- **冷却时间**: 0.5秒
- **连发数量**: 2发
- **初始状态**: 禁用
- **驱动类型**: G-Hub硬件级驱动

### 检测机制
- 使用与主系统相同的坐标计算方法
- 基于归一化坐标系统（0.0-1.0）
- 实时计算目标头部与检测图像中心的距离
- 当距离小于阈值时触发射击

### G-Hub驱动优势
- **硬件级控制**: 直接与罗技硬件通信，更稳定可靠
- **兼容性强**: 与罗技G系列鼠标完美兼容
- **延迟更低**: 硬件级操作减少系统延迟
- **安全性高**: 使用官方驱动接口，降低检测风险
- **统一控制**: 与瞄准系统使用相同的G-Hub驱动

## 状态信息说明

按下 `R` 键后显示的状态信息包括：

```
==================================================
自动扳机系统状态报告
==================================================
功能状态: 启用/禁用
对齐阈值: 15.0像素
冷却时间: 0.5秒
连发数量: 2发
总触发次数: X
总射击次数: X
冷却剩余: X秒
==================================================
```

### 状态字段解释
- **功能状态**: 当前是否启用扳机功能
- **对齐阈值**: 触发射击的距离阈值
- **冷却时间**: 每次触发后的等待时间
- **连发数量**: 每次触发的射击次数
- **总触发次数**: 累计触发次数
- **总射击次数**: 累计射击次数
- **冷却剩余**: 当前冷却剩余时间

## 与其他功能的集成

### 精准瞄准优化器
- 扳机功能与瞄准优化器协同工作
- 瞄准优化器负责移动准星到目标
- 扳机功能负责在对齐时自动射击

### 动态追踪系统
- 可与动态追踪系统同时使用
- 追踪系统提供平滑的目标跟踪
- 扳机功能在合适时机自动射击

### 现有控制
- 不影响现有的 Caps Lock 瞄准功能
- 不影响现有的模式切换功能
- 完全独立的控制系统

## 使用建议

### 最佳实践
1. **先熟悉基本瞄准功能**
   - 建议先掌握基本的瞄准和追踪功能
   - 了解各种模式的特点

2. **合理使用扳机功能**
   - 在需要快速反应的情况下启用
   - 在练习瞄准时可以禁用

3. **注意冷却时间**
   - 触发后有0.5秒冷却，避免连续触发
   - 可根据游戏节奏调整使用策略

### 注意事项
- 扳机功能基于视觉检测，准确性取决于目标识别质量
- 建议在光线良好、目标清晰的环境下使用
- 冷却机制防止过度射击，但仍需注意弹药管理

## 故障排除

### 常见问题

**Q: 扳机功能不触发？**
A: 检查以下项目：
- 确认已按 `Caps Lock` 键启用功能
- 确认目标检测正常工作
- 确认对齐阈值设置合理

**Q: 触发过于频繁？**
A: 可能的解决方案：
- 调整对齐阈值（增大阈值）
- 检查目标检测的稳定性

**Q: 射击时机不准确？**
A: 建议：
- 确保目标检测模型工作正常
- 检查游戏设置和显示设置
- 调整对齐阈值以适应具体情况

## 技术支持

如果遇到问题，可以：
1. 查看控制台输出的调试信息
2. 使用 `R` 键检查系统状态
3. 重启程序重置系统状态

---

**版本**: 1.0  
**更新日期**: 2024年12月  
**兼容性**: 与主程序 main_onnx.py 完全兼容