# 调试信息增强说明

## 概述
为了帮助调试移动不准确的问题，我们在瞄准系统中增加了详细的调试信息输出。每次系统移动到目标头部时，都会输出详细的计算过程和终点目标信息。

## 新增的调试信息

### 1. 瞄准目标输入参数 (`[AIM_DEBUG]`)
```
🎯 [AIM_DEBUG] 开始瞄准目标
[AIM_DEBUG] 输入参数:
  - 目标位置: (200.0, 100.0)
  - 准星位置: (160.0, 160.0)
  - 置信度: 0.90
  - 游戏FOV: 103.0°
  - 检测尺寸: 320x320
  - 游戏分辨率: 2560x1600
```

### 2. 边界检查信息
```
[AIM_DEBUG] ✅ 目标在安全边界内: (200.0, 100.0)
或
[AIM_DEBUG] ⚠️ 目标超出安全边界: (1000.0, 1000.0)
[AIM_DEBUG] 安全边界: 边距=20px, 范围=[20, 300]
```

### 3. 目标对齐状态
```
[AIM_DEBUG] ✅ 目标已对齐，无需移动
或
[AIM_DEBUG] ❌ 目标未对齐，需要移动
```

### 4. 静态瞄准详细计算 (`[STATIC_DEBUG]`)
```
[STATIC_DEBUG] 🎯 开始静态瞄准计算
[STATIC_DEBUG] 输入: 目标(200.0, 100.0), 准星(160.0, 160.0)
[STATIC_DEBUG] 坐标系统初始化完成
[STATIC_DEBUG] 计算偏移信息...
[STATIC_DEBUG] 偏移信息: {详细的偏移数据}
[STATIC_DEBUG] 计算鼠标移动...
[STATIC_DEBUG] 角度偏移: H=1.609°, V=-2.862°
[STATIC_DEBUG] 🎯 静态瞄准结果:
[STATIC_DEBUG]   目标: (200.0, 100.0)
[STATIC_DEBUG]   准星: (160.0, 160.0)
[STATIC_DEBUG]   像素差: X=40.0px, Y=-60.0px
[STATIC_DEBUG]   角度偏移: H=1.609°, V=-2.862°
[STATIC_DEBUG]   鼠标移动: (128, -228)
```

### 5. 移动优化过程
```
[AIM_DEBUG] 🔧 应用移动优化...
[AIM_DEBUG] 原始移动: (128, -228)
[AIM_DEBUG] 平滑度处理 (smoothness=0.8): (128, -228) -> (102, -182)
[AIM_DEBUG] 距离限制 (max=50px): (102, -182) -> (50, -50)
[AIM_DEBUG] 🎯 最终优化移动: (50, -50)
```

### 6. 移动终点和精度分析
```
[AIM_DEBUG] 📍 移动终点: 准星(160.0, 160.0) + 移动(50, -50) = 新位置(210.0, 110.0)
[AIM_DEBUG] 🎯 目标位置: (200.0, 100.0)
[AIM_DEBUG] 📏 移动后距离目标: X差=10.0px, Y差=10.0px
```

## 调试信息标签说明

| 标签 | 用途 | 说明 |
|------|------|------|
| `[AIM_DEBUG]` | 瞄准流程调试 | 显示瞄准过程的主要步骤和状态 |
| `[STATIC_DEBUG]` | 静态瞄准计算 | 详细显示静态瞄准的计算过程 |
| `[STATIC-FIXED]` | 简化输出 | 保持原有的简化调试信息 |
| `[COORD]` | 坐标系统 | 坐标系统初始化和计算信息 |

## 如何使用调试信息

### 1. 检查输入参数
确认目标位置、准星位置、游戏参数是否正确。

### 2. 验证边界检查
确保目标在安全边界内，如果超出边界，系统会拒绝移动。

### 3. 分析计算过程
- **像素差**: 目标与准星的像素距离
- **角度偏移**: 转换为游戏内角度的偏移量
- **鼠标移动**: 计算出的鼠标移动距离

### 4. 检查优化效果
- **平滑度处理**: 查看平滑度参数的影响
- **距离限制**: 确认是否被最大移动距离限制
- **移动精度**: 分析移动后与目标的距离差

### 5. 问题诊断
- 如果移动距离过大，检查最大移动限制设置
- 如果移动不准确，检查坐标系统参数
- 如果目标被拒绝，检查边界设置

## 测试示例

运行 `test_debug_output.py` 可以看到完整的调试信息输出示例：

```bash
python test_debug_output.py
```

这将显示4个不同场景的详细调试信息，帮助理解系统的工作原理。

## 注意事项

1. **坐标系统**: 确保使用正确的坐标系统（检测尺寸 vs 游戏分辨率）
2. **边界检查**: 目标必须在检测尺寸范围内（默认320x320）
3. **移动限制**: 大距离移动会被限制在最大单次移动范围内
4. **性能影响**: 详细调试信息会影响性能，生产环境中可以选择性关闭

## 配置参数

可以通过以下参数调整系统行为：
- `optimized_tracking`: 是否启用优化跟踪
- `tracking_smoothness`: 移动平滑度 (0.0-1.0)
- `max_single_move`: 最大单次移动距离（像素）
- `boundary_margin`: 安全边界边距（像素）